[build]
  base = "."
  command = "npm install && npm run build"
  publish = "Brandible"

# Force HTTPS redirects - must be first to ensure all HTTP traffic is redirected
# Redirect non-www HTTP to www HTTPS (canonical domain)
[[redirects]]
  from = "http://brandiblemg.com/*"
  to = "https://www.brandiblemg.com/:splat"
  status = 301
  force = true

[[redirects]]
  from = "http://www.brandiblemg.com/*"
  to = "https://www.brandiblemg.com/:splat"
  status = 301
  force = true

# Redirect non-www HTTPS to www HTTPS (canonical domain)
# This must come before the catch-all to ensure proper domain canonicalization
[[redirects]]
  from = "https://brandiblemg.com/*"
  to = "https://www.brandiblemg.com/:splat"
  status = 301
  force = true

# Catch-all HTTP to HTTPS redirect (fallback)
[[redirects]]
  from = "http://*"
  to = "https://:splat"
  status = 301
  force = true

# Rewrite .html files to trailing slash versions (internal rewrite, no redirect)
[[redirects]]
  from = "/terms/"
  to = "/terms.html"
  status = 200

[[redirects]]
  from = "/privacy/"
  to = "/privacy.html"
  status = 200

# Redirect .html extension to trailing slash version
[[redirects]]
  from = "/terms.html"
  to = "/terms/"
  status = 301

[[redirects]]
  from = "/privacy.html"
  to = "/privacy/"
  status = 301

# Ensure trailing slashes for directory-based pages
[[redirects]]
  from = "/about"
  to = "/about/"
  status = 301

[[redirects]]
  from = "/contact"
  to = "/contact/"
  status = 301

[[redirects]]
  from = "/portfolio"
  to = "/portfolio/"
  status = 301

[[redirects]]
  from = "/services"
  to = "/services/"
  status = 301

[[redirects]]
  from = "/faqs"
  to = "/faqs/"
  status = 301

[[redirects]]
  from = "/careers"
  to = "/careers/"
  status = 301

[[redirects]]
  from = "/blogs"
  to = "/blogs/"
  status = 301

# Redirect old blog post URLs to new format for better SEO
# Redirect /blogs/post.html?slug=* to /blogs/[slug]/ (new format with static HTML)
# Note: Netlify doesn't support query parameter matching in redirects,
# so we'll handle this via JavaScript in the generated HTML files
# The old format will still work but will redirect to the new format

# Redirect /blogs/post/ to /blogs/ (invalid without slug)
[[redirects]]
  from = "/blogs/post"
  to = "/blogs/"
  status = 301

[[redirects]]
  from = "/blogs/post/"
  to = "/blogs/"
  status = 301

# Service subdirectories - ensure trailing slashes
[[redirects]]
  from = "/services/web-design"
  to = "/services/web-design/"
  status = 301

[[redirects]]
  from = "/services/digital-marketing"
  to = "/services/digital-marketing/"
  status = 301

[[redirects]]
  from = "/services/branding"
  to = "/services/branding/"
  status = 301

[[redirects]]
  from = "/services/media-management"
  to = "/services/media-management/"
  status = 301

# Favicon rewrite - serve favicon.ico from assets directory
[[redirects]]
  from = "/favicon.ico"
  to = "/assets/favicon.ico"
  status = 200

# Explicit rewrites to ensure URLs return 200 OK
# This prevents Google from seeing redirect errors
# Homepage rewrite - ensure root returns 200 OK
[[redirects]]
  from = "/"
  to = "/index.html"
  status = 200

[[redirects]]
  from = "/about/"
  to = "/about/index.html"
  status = 200

[[redirects]]
  from = "/contact/"
  to = "/contact/index.html"
  status = 200

[[redirects]]
  from = "/portfolio/"
  to = "/portfolio/index.html"
  status = 200

[[redirects]]
  from = "/services/"
  to = "/services/index.html"
  status = 200

[[redirects]]
  from = "/faqs/"
  to = "/faqs/index.html"
  status = 200
  force = true

[[redirects]]
  from = "/careers/"
  to = "/careers/index.html"
  status = 200

[[redirects]]
  from = "/blogs/"
  to = "/blogs/index.html"
  status = 200

# Note: Generated blog post HTML files at /blogs/[slug]/index.html
# are automatically served by Netlify when visiting /blogs/[slug]/

[[redirects]]
  from = "/admin/"
  to = "/admin/index.html"
  status = 200

# Explicit rewrites for service subdirectories
[[redirects]]
  from = "/services/web-design/"
  to = "/services/web-design/index.html"
  status = 200

[[redirects]]
  from = "/services/digital-marketing/"
  to = "/services/digital-marketing/index.html"
  status = 200

[[redirects]]
  from = "/services/branding/"
  to = "/services/branding/index.html"
  status = 200

[[redirects]]
  from = "/services/media-management/"
  to = "/services/media-management/index.html"
  status = 200

